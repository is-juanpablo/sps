/**
 * Author:  Juan Pablo
 * Created: 22/03/2020
 */
-- ==============  ELIMINAR TABLAS ============== 
DROP TABLE RESERVA;
DROP TABLE USUARIO;
DROP TABLE CLIENTE;
DROP TABLE PERSONA;

-- ==============  CREACIÃ“N TABLAS ==============
CREATE TABLE PERSONA(
CEDULA VARCHAR(15) NOT NULL PRIMARY KEY,
NOMBRE VARCHAR(30) NOT NULL,
CONTRASENIA VARCHAR(100) NOT NULL,
CORREO VARCHAR(30) NOT NULL,
TELEFONO VARCHAR(15)
);

CREATE TABLE USUARIO(
ID_PERSONA VARCHAR(15) NOT NULL,
PLACA CHAR(6) NOT NULL PRIMARY KEY,
MARCA VARCHAR(15) NOT NULL,
ID_PROPIEDAD VARCHAR(20) NOT NULL
);

CREATE TABLE CLIENTE(
ID INT not null primary key
        GENERATED ALWAYS AS IDENTITY
        (START WITH 1, INCREMENT BY 1),
ID_PERSONA VARCHAR(15) NOT NULL,
DIRECCION VARCHAR(50) NOT NULL,
CUPOS INTEGER NOT NULL,
INICIO CHAR(5) NOT NULL,
FIN CHAR(5),
PRECIO DOUBLE NOT NULL
);

CREATE TABLE RESERVA(
ID INT not null primary key
        GENERATED ALWAYS AS IDENTITY
        (START WITH 1, INCREMENT BY 1),
DIA CHAR(10) NOT NULL,
ENTRADA CHAR(8) NOT NULL,
SALIDA CHAR(8),
ID_USUARIO CHAR(6) NOT NULL,
ID_CLIENTE INT NOT NULL,
OCUPADO BOOLEAN NOT NULL,
PRECIO DOUBLE NOT NULL
);

-- ==============  ALTERAR TABLAS 'LLAVES FOREANAS'    ==============
ALTER TABLE USUARIO ADD CONSTRAINT ID_PERSONA_USUARIO FOREIGN KEY (ID_PERSONA) REFERENCES PERSONA(CEDULA);

ALTER TABLE CLIENTE ADD CONSTRAINT ID_PERSONA_CLIENTE FOREIGN KEY (ID_PERSONA) REFERENCES PERSONA(CEDULA);

ALTER TABLE RESERVA ADD CONSTRAINT USUARIO_RESERVA FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO(PLACA);

ALTER TABLE RESERVA ADD CONSTRAINT CLIENTE_RESERVA FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID);